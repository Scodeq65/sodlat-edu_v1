{% extends 'base.html' %}

{% block title %}Parent Dashboard{% endblock %}

{% block content %}
<h1>Parent Dashboard</h1>
<p>Welcome, {{ current_user.username }}!</p>

<!-- Link Child Form -->
<h2>Link Your Child</h2>
<form method="POST" action="{{ url_for('main.parent_dashboard') }}">
    {{ link_child_form.hidden_tag() }}
    <div>
        {{ link_child_form.child_name.label(class="form-label") }}<br>
        {{ link_child_form.child_name(class="form-control") }}<br>
        {% for error in link_child_form.child_name.errors %}
            <span class="error">{{ error }}</span><br>
        {% endfor %}
    </div>
    <div>
        <input type="submit" value="Link Child" class="btn btn-primary">
    </div>
</form>

<!-- Linked Children List -->
<h2>Your Linked Children</h2>
<ul>
    {% for child in current_user.children %}
        <li>{{ child.name }}</li>
    {% endfor %}
</ul>

<!-- Child's Progress -->
<h2>Child's Progress</h2>
{% if current_user.children %}
    {% for child in current_user.children %}
        <h3>{{ child.name }}</h3>
        {% if child.progress %}
            <ul>
                {% for progress in child.progress %}
                    <li>Course: {{ progress.course_name }}, Grade: {{ progress.grade }}, Attendance: {{ progress.attendance }}, Performance: {{ progress.overall_performance }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No progress data available.</p>
        {% endfor %}
    {% endfor %}
{% else %}
    <p>No children linked yet.</p>
{% endif %}
{% endblock %}