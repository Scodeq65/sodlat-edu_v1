{% extends 'base.html' %}

{% block title %}Parent Dashboard{% endblock %}

{% block content %}
<h1>Parent Dashboard</h1>
<p>Welcome, {{ current_user.username }}!</p>

<!-- Link Child Form -->
<h2>Link Your Child</h2>
<form method="POST" action="{{ url_for('main.parent_dashboard') }}">
    {{ link_child_form.hidden_tag() }}
    <div>
        {{ link_child_form.child_name.label(class="form-label") }}<br>
        {{ link_child_form.child_name(class="form-control") }}<br>
        {% if link_child_form.child_name.errors %}
            {% for error in link_child_form.child_name.errors %}
                <span class="error">{{ error }}</span><br>
            {% endfor %}
        {% endif %}
    </div>
    <div>
        <input type="submit" value="Link Child" class="btn btn-primary">
    </div>
</form>

<!-- Linked Children List -->
<h2>Your Linked Children</h2>
<ul>
    {% for child in children %}
        <li>{{ child.username }}</li>
    {% endfor %}
</ul>

<!-- Child's Progress -->
<h2>Child's Progress</h2>
{% if children %}
    {% for child in children %}
        <h3>{{ child.username }}</h3>
        {% if progress.get(child.id) %}
            <ul>
                {% for prog in progress[child.id] %}
                    <li>Course: {{ prog.course_name }}, Grade: {{ prog.grade }}, Attendance: {{ prog.attendance }}, Performance: {{ prog.overall_performance }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No progress data available for {{ child.username }}.</p>
        {% endif %}
    {% endfor %}
{% else %}
    <p>No children linked yet.</p>
{% endif %}
{% endblock %}
